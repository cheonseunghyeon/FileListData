<!-- templates/index.html (HTML 템플릿) -->
<!DOCTYPE html>
<html>
<head>
    <title>Netlist Processing</title>
        <link
      href="https://fonts.googleapis.com/css2?family=Alata&display=swap"
      rel="stylesheet"
    />
    <style>
        @font-face {
            font-family: 'NPSfontBold';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2310@1.0/NPSfontBold.woff2') format('woff2');
            font-weight: 700;
            font-style: normal;
        }
        *{
            font-family: 'NPSfontBold';
            font-size: 15px;
            margin: 5px;
        }
        table {
            border-collapse: collapse;
        }
        .table-row:hover {
            background-color: gray; 
        }
        .table-row:nth-child(odd) {
            background-color: white;
        }
        .table-row:nth-child(even) {
            background-color: papayawhip;
        }
        .table-row:nth-child(1) {
            font-weight: bold;
            font-size: 13px;
            background-color: powderblue;
            cursor: pointer;
        }
    table, th, td {
        border: 1px solid black;
        padding: 4px; /* 셀 간격 조절 */
    }
    .header{
        margin: 1rem;
        margin-top: 3rem;
        gap : 1rem;
        padding: 30px;

        border-radius: 10px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }
    .body{
        overflow-x: auto; 
        width:3400px;
        margin: 1rem;
    }
    input, label, option, select,span{
        font-size: 18px;
    }
    label{
        margin: 15px;
    }
    .filebox .upload-name {
        display: inline-block;
        height: 40px;
        padding: 0 10px;
        vertical-align: middle;
        border: 1px solid #dddddd;
        width: 550px;
        color: #999999;
        border-radius: 10px;
        height: 60px;
    }
    .filebox label {
        display: inline-block;
        padding: 20px 20px 0px 20px;
        color: #fff;
        vertical-align: middle;
        background-color: #999999;
        cursor: pointer;
        height: 40px;
        margin-left: 10px;
        border-radius: 5px;
        transition: background-color 0.3s; 
    }
    .filebox label:hover {
        background-color: #333333;
    }
    .filebox input[type="file"] {
        position: absolute;
        width: 0;
        height: 0;
        padding: 0;
        overflow: hidden;
        border: 0;
    }
    select {
        width: 100px;
        height: 30px;
        padding-left: 10px;
        font-size: 18px;
        border-radius: 3px;
    }
    select::-ms-expand {
        display: none;
    }

    select option:checked,
    select option:hover {
        background:  #333333;
        color: white;
    }

    select option:checked,
    select option:hover {
        box-shadow: 0 0 10px 100px powderblue inset;
        color: white;
    }
    input[type="text"] {
        width: 190px;
    }
    input[type="submit"] {
        width: 300px;
        padding: 20px;
        border-radius: 7px;
        border: 0px;
        cursor: pointer;
        color: white;
        background-color: #999999;
        transition: background-color 0.3s; 
    }
    input[type="submit"]:hover {
        background-color: #333333;
    }
    .centers{
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: center;
    }
    .firstcon{
        /* background-color: #999999; */
        margin-bottom: 20px;
    }
    .firstcontainer{
        padding: 20px;
        border: 2px solid black;
        border-radius: 20px;
        background-color: #EBFBFF;
    }
    .headcon{
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }
    .buttons{
        width: 300px;
        padding: 20px;
        border-radius: 7px;
        border: 0px;
        cursor: pointer;
        color: white;
        transition: background-color 0.3s; 
        background-color: #999999;
    }

    .buttons:hover {
        background-color: #333333;
    }
    </style>
</head>
<body>

    <div class="header">
        <form action="/" method="POST" enctype="multipart/form-data" class="forms">
            <div class="headcon">
                <div class="filebox">
                    {% if FileName %}
                    <input class="upload-name" value="{{ FileName }}" placeholder="첨부파일">
                    {% else %}
                        <input class="upload-name" value="첨부파일" placeholder="첨부파일">
                    {% endif %}
                    <label for="file">파일찾기</label>
                    <input type="file" name="netlist_file" accept=".xls, .xlsx" id="file">
                </div>
            </div>

            <br/>
            <div class="firstcontainer">
                <div class="firstcon">
                    <label for="str">상태:</label>
                    <select name="str" id="str">
                        <option value="">전체</option>
                        <option value="예약">예약</option>
                        <option value="완료">완료</option>
                    </select>
                    <label for="installer">시공자:</label>
                    <select name="installer" id="installer">
                        <option value="">전체</option>
                        <option value="태훈">태훈</option>
                        <option value="용균">용균</option>
                        <option value="김경">김경</option>
                        <option value="이인">이인</option>
                        <option value="박찬">박찬</option>
                        <option value="정병">정병</option>
                        <option value="안심">안심</option>
                        <option value="인효">인효</option>
                        <option value="권병">권병</option>
                        <option value="광주">광주</option>
                        <option value="조근">조근</option>
                        <option value="오수">오수</option>
                        <option value="홍진">홍진</option>
                        <option value="이천">이천</option>
                        <option value="시흥">시흥</option>
                        <option value="평택">평택</option>
                    </select>
                    <label for="group">소속:</label>
                    <select name="group" id="group">
                        <option value="">전체</option>
                        <option value="영남">영남</option>
                        <option value="서울">서울</option>
                    </select>
                    <label for="time">시간:</label>
                    <select name="time" id="time">
                        <option value="">전체</option>
                        <option value="오전">오전</option>
                        <option value="오후">오후</option>
                    </select>
                </div>
                <!-- 필터 입력 요소 -->
                
                <div >
                    <label for="apart">그룹:</label>
                    <input type="text" id="apart" name="apart" />
        
                    <label for="date1">기간:</label>
                        <input type="date" id="date1" name="date1">
                    <label for="date2">~ </label>
                        <input type="date" id="date2" name="date2">
        
                </div>
            </div>
            
                <br/>
                <div class="centers">
                    <input type="submit" value="검색">
                    <a href="/download_excel" class="download-button">
                        <input type="button" value="다운" class="buttons">
                    </a>
                </div>
        </form>
    </div>
    <!-- DataFrame 표시 -->
    <hr style="border: solid 1px #dddddd; margin-bottom: 50px;">
    <div class="body">
        <table style="border-collapse: separate; border-spacing: 5px;">
            <tbody>
                {% if df is defined and not df is none and not df.empty %}
                    {% for _, row in df.iterrows() %}
                        <tr class="table-row" {% if '만원/' in row[4] and '평' in row[4] %}
                            {% set area = row[4].split('만원/')[1].split('평')[0] %}
                            {% if area|float >= 44 %}style="background-color: #FF92B1;"{% endif %}{% endif %}>
                            <td>{{ loop.index - 1 }}</td>
                            {% for _, value in row.items() %}
                                <td>
                                    {% if value is string %}
                                        {{ value[:100] }}
                                    {% else %}
                                        {{ value }}
                                    {% endif %}
                                </td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="4">No data to display.</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
    <script>
document.addEventListener("DOMContentLoaded", function() {
    const table = document.querySelector("table");
    const rows = table.querySelectorAll(".table-row");
    let sortAsc = true;

    // 첫 번째 행 (헤더)만 클릭 이벤트를 등록
    rows[0].querySelectorAll("td").forEach(function(cell, index) {
        cell.addEventListener("click", function() {
            // 현재 배경색 가져오기
            const currentColor = cell.style.backgroundColor;

            // 클릭한 요소의 배경색을 변경
            if (currentColor === "gray" || currentColor === "") {
                // 선택한 열의 배경색 변경
                rows[0].querySelectorAll("td").forEach(function(cell) {
                    cell.style.backgroundColor = "";
                });
                rows[0].querySelectorAll("td").forEach(function(cell) {
                    cell.style.backgroundColor = "lightblue";
                });
            } else {
                // 클릭한 열의 배경색 제거
                rows[0].querySelectorAll("td").forEach(function(cell) {
                    cell.style.backgroundColor = "";
                });
            }

            cell.style.backgroundColor = "#A366FF";

            // 데이터 정렬 및 번호 표시
            sortTable(index);
        });
    });

    function sortTable(index) {
        const rows = Array.from(table.rows);

        rows.shift(); // 첫 번째 행 (헤더) 제외

        rows.sort(function(rowA, rowB) {
            // 두 행의 데이터를 가져와 비교
            const cellA = rowA.cells[index].innerText;
            const cellB = rowB.cells[index].innerText;

            const result = cellA.localeCompare(cellB, undefined, { numeric: true, sensitivity: "base" });

            return sortAsc ? result : -result;
        });

        sortAsc = !sortAsc; // 방향 반전

        // 정렬된 행을 테이블에 추가
        const tbody = table.querySelector("tbody");
        rows.forEach(function(row, rowIndex) {
            row.cells[0].innerText = rowIndex + 1; // 번호 표시
            tbody.appendChild(row);
        });
    }
});

document.addEventListener("DOMContentLoaded", function() {
    const fileInput = document.getElementById("file");
    const uploadName = document.querySelector(".upload-name");

    fileInput.addEventListener("change", function(event) {
        const fileName = event.target.value.split('\\').pop();
        uploadName.value = fileName;
    });
});
    </script>
    
    
</body>
</html>
